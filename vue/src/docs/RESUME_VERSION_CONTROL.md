# 简历版本控制系统使用指南

## 📋 系统概述

本系统基于Git版本管理理念，为简历编辑提供完整的版本控制功能，让您可以像管理代码一样管理简历的不同版本。

## 🚀 主要功能

### 1. 版本控制初始化

- 为现有简历启用版本控制
- 自动创建初始提交（Initial commit）
- 建立main分支作为主分支

### 2. 提交管理

- **提交更改**：保存当前编辑状态为一个版本快照
- **提交信息**：为每次提交添加描述性信息
- **提交历史**：查看所有历史提交记录

### 3. 分支管理

- **创建分支**：从当前位置创建新的开发分支
- **切换分支**：在不同分支间自由切换
- **分支合并**：将一个分支的内容合并到另一个分支
- **分支可视化**：通过图形界面查看分支结构

### 4. 高级功能

- **检出（Checkout）**：回到任意历史版本
- **储藏（Stash）**：临时保存当前修改
- **弹出储藏**：恢复之前储藏的修改

## 🎯 使用场景

### 场景1：不同职位的简历版本

```
main分支：基础简历
├── frontend-dev：前端开发职位版本
├── backend-dev：后端开发职位版本
└── fullstack：全栈开发职位版本
```

### 场景2：简历迭代优化

```
v1.0：初始版本
├── feature/add-projects：添加项目经验
├── feature/improve-skills：完善技能描述
└── release/v2.0：发布新版本
```

### 场景3：实验性修改

```
main：稳定版本
└── experimental：尝试新的排版和内容
```

## 🛠️ 操作指南

### 初始化版本控制

1. 打开简历编辑器
2. 点击"启用版本控制"按钮
3. 系统自动创建初始提交和main分支

### 提交更改

1. 编辑简历内容
2. 点击"显示版本控制面板"
3. 在"提交更改"区域输入提交信息
4. 点击"提交到 'main'"按钮

### 创建和切换分支

1. 在版本控制面板的"分支管理"区域
2. 输入新分支名称，点击"创建"
3. 使用下拉菜单切换到不同分支

### 合并分支

1. 确保当前在目标分支（如main）
2. 在"合并分支"下拉菜单选择源分支
3. 点击"合并到 main"按钮
4. 确认合并操作

### 查看历史和检出

1. 在版本控制面板右侧查看提交历史图
2. 点击图表中的节点或表格中的"检出"按钮
3. 确认检出到指定版本

### 储藏功能

1. 当前有未提交的修改时
2. 点击"储藏当前更改"保存临时修改
3. 需要时点击"弹出储藏"恢复修改

## 💡 最佳实践

### 分支命名规范

- `main`：主分支，保持稳定版本
- `feature/功能名`：新功能开发分支
- `fix/修复描述`：修复问题的分支
- `职位类型`：针对特定职位的简历版本

### 提交信息规范

- 使用清晰的描述性语言
- 说明本次修改的主要内容
- 例如：
  - "添加新的项目经验：电商平台开发"
  - "优化技能描述，突出前端技术栈"
  - "修复教育经历的时间格式"

### 工作流程建议

#### 单人维护流程

```
1. 在main分支维护基础简历
2. 为不同职位创建专门分支
3. 定期将改进合并回main分支
4. 使用储藏功能处理临时修改
```

#### 多版本管理流程

```
1. main分支：通用版本
2. 创建针对性分支：
   - frontend：前端职位版本
   - backend：后端职位版本
   - management：管理岗位版本
3. 各分支独立维护和优化
4. 通用改进合并到main
```

## 🔧 技术架构

### 后端架构

- **实体层**：Resume、ResumeCommit
- **服务层**：ResumeVersionControlService
- **控制层**：ResumeVersionController
- **存储层**：MongoDB

### 前端架构

- **组件层**：ResumeVersionControl
- **API层**：version.ts
- **状态管理**：与EditorStore集成
- **可视化**：基于G6的提交历史图

### 数据结构

```typescript
// 简历实体
interface Resume {
  id: string
  hasVersionControl: boolean
  currentBranch: string
  headCommit?: string
  branches: Record<string, string>
  stashStack: Array<Record<string, any>>
}

// 提交记录
interface ResumeCommit {
  id: string
  message: string
  content: string
  branch: string
  parentCommits: string[]
  commitType: string
  commitTime: Date
}
```

## ⚠️ 注意事项

1. **数据安全**：版本控制会保存所有历史版本，请注意敏感信息
2. **存储空间**：历史版本会占用额外存储空间
3. **网络依赖**：版本控制操作需要网络连接到后端服务
4. **操作不可逆**：某些操作（如reset）不可撤销，请谨慎操作

## 🆘 常见问题

### Q: 如何删除不需要的分支？

A: 目前版本暂不支持分支删除，这是为了保护数据安全。

### Q: 提交后能否撤销？

A: 可以通过检出到之前的提交来"撤销"，但原提交仍会保留在历史中。

### Q: 储藏的内容会丢失吗？

A: 储藏的内容会持久保存，直到您主动弹出或被新的储藏覆盖。

### Q: 合并冲突如何处理？

A: 当前版本使用简单的合并策略（源分支内容覆盖），未来版本将添加冲突解决功能。

## 🎉 结语

简历版本控制系统让您能够专业地管理简历的多个版本，无论是针对不同职位的定制化，还是内容的持续优化，都能得到很好的支持。祝您求职顺利！

---

_如有问题或建议，请联系开发团队。_

## 🆕 高级回溯功能指南

### 快速回溯

1. **打开版本控制面板**：点击"显示版本控制面板"按钮
2. **加载最近提交**：在"高级回溯功能"区域点击"加载最近提交"
3. **选择操作**：对任意提交执行以下操作：
   - **检出**：切换到该提交，不影响历史
   - **重置**：将当前分支重置到该提交（危险操作）
   - **回滚**：创建新提交撤销该提交的更改（安全操作）

### 手动回溯

1. 在"回溯工具"区域输入提交ID（至少8位）
2. 选择"重置"或"回滚"操作
3. 确认操作并等待完成

### 历史表格回溯

在"提交记录"表格中，每一行都包含三个操作按钮：

- 🔍 **检出**：快速切换到该版本
- ⚠️ **重置**：重置分支到该版本（会丢失后续历史）
- ✅ **回滚**：安全地撤销该版本的更改

### 最佳实践

#### 选择合适的回溯方式

```
简单查看历史版本 → 使用"检出"
发现严重错误且确定要丢失后续更改 → 使用"重置"
发现错误但想保留完整历史 → 使用"回滚"
```

#### 回溯操作流程

```
1. 首先尝试"检出"确认目标版本正确
2. 如果需要永久回退，选择"回滚"（推荐）
3. 只有在确定要丢失历史时才使用"重置"
```

### ⚠️ 重要提醒

- **重置操作不可逆**：会永久丢失目标提交之后的所有更改
- **回滚操作安全**：创建新提交，可以再次回滚
- **操作有审计**：所有回溯操作都会被记录
- **建议先备份**：重要更改前建议创建新分支备份

### 🎯 使用场景示例

#### 场景1：发现刚才的修改有问题

```
1. 使用"回滚"功能撤销最近的提交
2. 重新进行正确的修改
3. 提交新版本
```

#### 场景2：想要回到很早的版本重新开始

```
1. 使用"检出"查看目标版本
2. 确认版本正确后使用"重置"
3. 从该版本继续开发
```

#### 场景3：只是想查看历史版本

```
1. 使用"检出"切换到历史版本
2. 查看内容后切换回主分支
3. 不进行任何修改
```

---

_版本控制系统让您的简历管理更加专业和安全！✨_
